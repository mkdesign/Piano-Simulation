<!doctype html>
<html lang="en-US" direction="ltr">
<head>
	<meta charset="utf-8" />
	<title>First rythms</title>
	<script src="jquery.js" ></script>
	<script src="buffer-load.js"></script>
	
</head>
<body>
	<div>
		<h3>Play all the audio buffers together.</h3>
		<input type="button" value="Play" onclick="playrythm(bufferLoader.bufferList);" />
	</div>
	<script>
		var songNotes = [3,7,7,6,5,6,7,7,6,3,7,7,6,5,6,7,7,6,3,7,7,6,5,6,7,7,6,9,3,7,7,6,5,6,7,7,6,0,7,1,2,6,7,7,6,3,7,7,6,5,6,7,7,6,9,3,7,7,6,5,6,7,7,6,0,9,9,9,9,9,9,6,7,7,6,0,9,9,9,9,9,9,6,7,7,6,2,5,5,2,5,5,2,5,5,4,3,2,3,4,5,2,5,5,4,3,2,6,6,6,6,6,6,2,5,5,4,3,2,3,4,5,2,5,5,4,3,2,6,0,5,5,2,5,0,4,4,2,6,0,5,5,2,5,0,4,4,2,5,0,4,4,2,4,0,3,3,3];

		var songRhythm = [0,0.125,0.0625,0.0625,0.125,0.125,0.125,0.0625,0.0625,0.25,0.125,0.0625,0.0625,0.125,0.125,0.125,0.0625,0.0625,0.25,0.125,0.0625,0.0625,0.125,0.125,0.125,0.0625,0.0625,0.125,0.125,0.125,0.0625,0.0625,0.125,0.125,0.125,0.0625,0.0625,0.25,0.125,0.125,0.125,0.125,0.125,0.0625,0.0625,0.25,0.125,0.0625,0.0625,0.125,0.125,0.125,0.0625,0.0625,0.125,0.125,0.125,0.0625,0.0625,0.125,0.125,0.125,0.0625,0.0625,0.25,0.125,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.125,0.0625,0.0625,0.25,0.125,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.125,0.0625,0.0625,0.25,0.125,0.0625,0.0625,0.125,0.0625,0.0625,0.125,0.0625,0.0625,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.0625,0.0625,0.125,0.125,0.125,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.125,0.0625,0.0625,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.0625,0.0625,0.125,0.125,0.125,0.125,0.125,0.0625,0.0625,0.125,0.125,0.125,0.0625,0.0625,0.125,0.125,0.125,0.0625,0.0625,0.125,0.125,0.125,0.0625,0.0625,0.125,0.125,0.125,0.0625,0.0625,0.125,0.125,0.125,0.0625,0.0625,0.5];

		window.onload = init;

		var context;
		var bufferLoader;
		var time = 0;

		function init() {
		    try {
		        context = new AudioContext();
		    }
		    catch(e) {
		        alert("Web Audio API is not supported in this browser");
		    }
		    
		    // Start loading the drum kit.
		    bufferLoader = new BufferLoader(
		        context,
		        [
		        
					'../piano/sound/A0.mp3',
					'../piano/sound/Bb0.mp3',
					'../piano/sound/B0.mp3',

					'../piano/sound/C1.mp3',
					'../piano/sound/Db1.mp3',
					'../piano/sound/D1.mp3',
					'../piano/sound/Eb1.mp3',
					'../piano/sound/E1.mp3',
					'../piano/sound/F1.mp3',
					'../piano/sound/Gb1.mp3',
					'../piano/sound/G1.mp3',
					'../piano/sound/Ab1.mp3',
					'../piano/sound/A1.mp3',
					'../piano/sound/Bb1.mp3',
					'../piano/sound/B1.mp3',

					'../piano/sound/C2.mp3',
					'../piano/sound/Db2.mp3',
					'../piano/sound/D2.mp3',
					'../piano/sound/Eb2.mp3',
					'../piano/sound/E2.mp3',
					'../piano/sound/F2.mp3',
					'../piano/sound/Gb2.mp3',
					'../piano/sound/G2.mp3',
					'../piano/sound/Ab2.mp3',
					'../piano/sound/A2.mp3',
					'../piano/sound/Bb2.mp3',
					'../piano/sound/B2.mp3',

					'../piano/sound/C3.mp3',
					'../piano/sound/Db3.mp3',
					'../piano/sound/D3.mp3',
					'../piano/sound/Eb3.mp3',
					'../piano/sound/E3.mp3',
					'../piano/sound/F3.mp3',
					'../piano/sound/Gb3.mp3',
					'../piano/sound/G3.mp3',
					'../piano/sound/Ab3.mp3',
					'../piano/sound/A3.mp3',
					'../piano/sound/Bb3.mp3',
					'../piano/sound/B3.mp3',

					'../piano/sound/C4.mp3',
					'../piano/sound/Db4.mp3',
					'../piano/sound/D4.mp3',
					'../piano/sound/Eb4.mp3',
					'../piano/sound/E4.mp3',
					'../piano/sound/F4.mp3',
					'../piano/sound/Gb4.mp3',
					'../piano/sound/G4.mp3',
					'../piano/sound/Ab4.mp3',
					'../piano/sound/A4.mp3',
					'../piano/sound/Bb4.mp3',
					'../piano/sound/B4.mp3',

					'../piano/sound/C5.mp3',
					'../piano/sound/Db5.mp3',
					'../piano/sound/D5.mp3',
					'../piano/sound/Eb5.mp3',
					'../piano/sound/E5.mp3',
					'../piano/sound/F5.mp3',
					'../piano/sound/Gb5.mp3',
					'../piano/sound/G5.mp3',
					'../piano/sound/Ab5.mp3',
					'../piano/sound/A5.mp3',
					'../piano/sound/Bb5.mp3',
					'../piano/sound/B5.mp3',

					'../piano/sound/C6.mp3',
					'../piano/sound/Db6.mp3',
					'../piano/sound/D6.mp3',
					'../piano/sound/Eb6.mp3',
					'../piano/sound/E6.mp3',
					'../piano/sound/F6.mp3',
					'../piano/sound/Gb6.mp3',
					'../piano/sound/G6.mp3',
					'../piano/sound/Ab6.mp3',
					'../piano/sound/A6.mp3',
					'../piano/sound/Bb6.mp3',
					'../piano/sound/B6.mp3',

					'../piano/sound/C7.mp3',
					'../piano/sound/Db7.mp3',
					'../piano/sound/D7.mp3',
					'../piano/sound/Eb7.mp3',
					'../piano/sound/E7.mp3',
					'../piano/sound/F7.mp3',
					'../piano/sound/Gb7.mp3',
					'../piano/sound/G7.mp3',
					'../piano/sound/Ab7.mp3',
					'../piano/sound/A7.mp3',
					'../piano/sound/Bb7.mp3',
					'../piano/sound/B7.mp3',

					'../piano/sound/C8.mp3',

					 '../piano/sound/silence.wav',
		        ],
		        bufferLoadCompleted  
		    );

		    bufferLoader.load();
		}

		function bufferLoadCompleted (){
			
		}

		function playsong (buffer, time){
			var source = context.createBufferSource();
			source.buffer = buffer;
			source.connect(context.destination);
			source.start(time);
		}

		var ratio = 240/60;

		function playrythm (bufferList){
			var startTime = context.currentTime + 0.100;
			for(i=0;i<=songNotes.length;i++){
				time += songRhythm[i];
				playsong(bufferList[ songNotes[i] ],startTime+time*ratio);
			}
		}



	</script>
</body>
</html>
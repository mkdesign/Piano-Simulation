<!doctype html>
<html lang="en-US" direction="ltr">
<head>
	<meta charset="utf-8" />
	<title>First rythms</title>
	<script src="jquery.js" ></script>
	<script src="buffer-load.js"></script>
	
</head>
<body>
	<div>
		<h3>Play all the audio buffers together.</h3>
		<input type="button" value="Play" onclick="playrythm();" />
	</div>
	<script>
		var songNotes = [3,7,7,6,5,6,7,7,6,3,7,7,6,5,6,7,7,6,3,7,7,6,5,6,7,7,6,9,3,7,7,6,5,6,7,7,6,0,7,1,2,6,7,7,6,3,7,7,6,5,6,7,7,6,9,3,7,7,6,5,6,7,7,6,0,9,9,9,9,9,9,6,7,7,6,0,9,9,9,9,9,9,6,7,7,6,2,5,5,2,5,5,2,5,5,4,3,2,3,4,5,2,5,5,4,3,2,6,6,6,6,6,6,2,5,5,4,3,2,3,4,5,2,5,5,4,3,2,6,0,5,5,2,5,0,4,4,2,6,0,5,5,2,5,0,4,4,2,5,0,4,4,2,4,0,3,3,3];

		var songRhythm = [0,0.125,0.0625,0.0625,0.125,0.125,0.125,0.0625,0.0625,0.25,0.125,0.0625,0.0625,0.125,0.125,0.125,0.0625,0.0625,0.25,0.125,0.0625,0.0625,0.125,0.125,0.125,0.0625,0.0625,0.125,0.125,0.125,0.0625,0.0625,0.125,0.125,0.125,0.0625,0.0625,0.25,0.125,0.125,0.125,0.125,0.125,0.0625,0.0625,0.25,0.125,0.0625,0.0625,0.125,0.125,0.125,0.0625,0.0625,0.125,0.125,0.125,0.0625,0.0625,0.125,0.125,0.125,0.0625,0.0625,0.25,0.125,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.125,0.0625,0.0625,0.25,0.125,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.125,0.0625,0.0625,0.25,0.125,0.0625,0.0625,0.125,0.0625,0.0625,0.125,0.0625,0.0625,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.0625,0.0625,0.125,0.125,0.125,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.125,0.0625,0.0625,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.0625,0.0625,0.125,0.125,0.125,0.125,0.125,0.0625,0.0625,0.125,0.125,0.125,0.0625,0.0625,0.125,0.125,0.125,0.0625,0.0625,0.125,0.125,0.125,0.0625,0.0625,0.125,0.125,0.125,0.0625,0.0625,0.125,0.125,0.125,0.0625,0.0625,0.5];

		window.onload = init;

		var context;
		var bufferLoader;
		var time = 0;

		function init() {
		    try {
		        context = new AudioContext();
		    }
		    catch(e) {
		        alert("Web Audio API is not supported in this browser");
		    }
		    
		    // Start loading the drum kit.
		    bufferLoader = new BufferLoader(
		        context,
		        [
		        "../audio api/sound/silence.wav",
		        "../audio api/sound/mi.wav",
		        "../audio api/sound/fa.wav",
		        "../audio api/sound/sol.wav",
		        "../audio api/sound/la.wav",
		        "../audio api/sound/si.wav",
		        "../audio api/sound/do.wav",
		        "../audio api/sound/re.wav",
		        "../audio api/sound/mi8.wav",
		        "../audio api/sound/fa9.wav"
		        ],
		        bufferLoadCompleted  
		    );

		    bufferLoader.load();
		}

		function bufferLoadCompleted (){
			
		}

		function playsong (buffer, time){
			var source = context.createBufferSource();
			source.buffer = buffer;
			source.connect(context.destination);
			source.start(time);
		}



		function playrythm (bufferList){
			var startTime = context.currentTime + 0.100;
			for(i=0;i<=songNotes.length;i++){
				time += songRhythm[i];
				console.log(songNotes[i]);
				console.log(bufferList[songNotes[i]])
				playsong(bufferList[ songNotes[i] ],startTime+time);
			}
		}



	</script>
</body>
</html>